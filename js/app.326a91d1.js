(function(t){function e(e){for(var s,l,n=e[0],c=e[1],o=e[2],d=0,f=[];d<n.length;d++)l=n[d],Object.prototype.hasOwnProperty.call(i,l)&&i[l]&&f.push(i[l][0]),i[l]=0;for(s in c)Object.prototype.hasOwnProperty.call(c,s)&&(t[s]=c[s]);h&&h(e);while(f.length)f.shift()();return r.push.apply(r,o||[]),a()}function a(){for(var t,e=0;e<r.length;e++){for(var a=r[e],s=!0,n=1;n<a.length;n++){var c=a[n];0!==i[c]&&(s=!1)}s&&(r.splice(e--,1),t=l(l.s=a[0]))}return t}var s={},i={app:0},r=[];function l(e){if(s[e])return s[e].exports;var a=s[e]={i:e,l:!1,exports:{}};return t[e].call(a.exports,a,a.exports,l),a.l=!0,a.exports}l.m=t,l.c=s,l.d=function(t,e,a){l.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:a})},l.r=function(t){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},l.t=function(t,e){if(1&e&&(t=l(t)),8&e)return t;if(4&e&&"object"===typeof t&&t&&t.__esModule)return t;var a=Object.create(null);if(l.r(a),Object.defineProperty(a,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var s in t)l.d(a,s,function(e){return t[e]}.bind(null,s));return a},l.n=function(t){var e=t&&t.__esModule?function(){return t["default"]}:function(){return t};return l.d(e,"a",e),e},l.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},l.p="/infinite-scroll-sample/";var n=window["webpackJsonp"]=window["webpackJsonp"]||[],c=n.push.bind(n);n.push=e,n=n.slice();for(var o=0;o<n.length;o++)e(n[o]);var h=c;r.push([0,"chunk-vendors"]),a()})({0:function(t,e,a){t.exports=a("56d7")},"11be":function(t,e,a){"use strict";var s=a("5a83"),i=a.n(s);i.a},"336b":function(t,e,a){"use strict";var s=a("eefd"),i=a.n(s);i.a},"3b10":function(t,e,a){"use strict";var s=a("c6cb"),i=a.n(s);i.a},"43cf":function(t,e,a){},"56d7":function(t,e,a){"use strict";a.r(e);a("e260"),a("e6cf"),a("cca6"),a("a79d");var s=a("2b0e"),i=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{attrs:{id:"app"}},[a("router-view")],1)},r=[],l={name:"App"},n=l,c=(a("5c0b"),a("2877")),o=Object(c["a"])(n,i,r,!1,null,null,null),h=o.exports,d=a("8c4f"),f=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"navs"},[a("router-link",{attrs:{to:"/height-fixed"}},[t._v("height-fixed")]),a("router-link",{attrs:{to:"/height-dynamic"}},[t._v("height-dynamic")])],1)},u=[],m={name:"navs",data:function(){return{}}},p=m,g=(a("336b"),Object(c["a"])(p,f,u,!1,null,"426fe9f2",null)),_=g.exports,v=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("ul",{ref:"scroller",staticClass:"height-dynamic",on:{scroll:t.handleScroll}},[a("li",{ref:"scrollRunway",staticClass:"height-dynamic__scroll-runway",style:"transform: translate(0, "+t.scrollRunwayEnd+"px)"}),t._l(t.topPlaceholders,(function(e,s){return a("place-holder",{key:-s-1,staticClass:"height-dynamic__placeholder",style:"transform: translate(0, "+(t.cachedScrollY[t.firstAttachedItem]-t.ESTIMATED_HEIGHT*(s+1))+"px)"})})),t._l(t.visibleData,(function(e){return a("item",{key:e.username+e.phone,ref:"items",refInFor:!0,staticClass:"height-dynamic__item",style:"transform: translate(0, "+(t.cachedScrollY[e.index]||e.index*t.ESTIMATED_HEIGHT)+"px)",attrs:{data:e,"fixed-height":!1,index:e.index},on:{"size-change":t.handleSizeChange}})})),t._l(t.bottomPlaceholders,(function(e,s){return a("place-holder",{key:s+1,staticClass:"height-dynamic__placeholder",style:"transform: translate(0, "+(t.cachedScrollY[t.lastAttachedItem-1]+t.cachedHeight[t.lastAttachedItem-1]+t.ESTIMATED_HEIGHT*(s+1))+"px)"})}))],2)},x=[],I=(a("c740"),a("13d5"),a("fb6a"),a("96cf"),a("1da1")),b=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("li",{ref:"item",staticClass:"item"},[a("div",{staticClass:"item__wrapper",class:{"is-fixed":t.fixedHeight}},[a("div",{staticClass:"item__info"},[a("img",{staticClass:"item__avatar",attrs:{src:t.data.avatar}}),a("p",{staticClass:"item__name"},[t._v(t._s(t.index)+". "+t._s(t.data.name))]),a("p",{staticClass:"item__date"},[t._v(t._s(t.data.dob))])]),t.fixedHeight?[a("p",{staticClass:"item__text"},[t._v("E-mail: "+t._s(t.data.email))]),a("p",{staticClass:"item__text"},[t._v("Phone: "+t._s(t.data.phone))]),a("p",{staticClass:"item__text"},[t._v("City: "+t._s(t.data.address.city))]),a("p",{staticClass:"item__text"},[t._v("Street: "+t._s(t.data.address.street))])]:[a("p",{staticClass:"item__paragraph"},[t._v(t._s(t.data.paragraph))]),a("img",{staticClass:"item__img",style:{width:t.data.img.width},attrs:{src:t.imgSrc}}),a("img",{staticClass:"item__img",style:{width:t.data.img.width},attrs:{src:t.data.img.src}})]],2)])},y=[],D=(a("a9e3"),a("b85c")),S=a("6dd8"),$=a("359c"),T=a.n($),H={name:"item",props:{index:{type:Number,default:0},data:{type:Object,default:function(){return{}}},fixedHeight:{type:Boolean,default:!0}},data:function(){return{imgSrc:""}},mounted:function(){var t=this;this.fixedHeight||(this.ro=new S["a"]((function(e,a){var s,i=Object(D["a"])(e);try{for(i.s();!(s=i.n()).done;){var r=s.value;t.$emit("size-change",t.index,r.contentRect)}}catch(l){i.e(l)}finally{i.f()}})),this.ro.observe(this.$refs.item),this.data.img.isDeffer?this.imgSrc=this.data.img.src:setTimeout((function(){t.imgSrc=t.data.img.src,t.data.img.isDeffer=!0}),T.a.random.number({min:300,max:5e3})))},beforeDestroy:function(){this.ro&&this.ro.disconnect()}},w=H,A=(a("11be"),Object(c["a"])(w,b,y,!1,null,"68e9a55c",null)),C=A.exports,E=function(){var t=this,e=t.$createElement;t._self._c;return t._m(0)},P=[function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("li",{staticClass:"placeholder"},[a("div",{staticClass:"placeholder__wrapper"},[a("div",{staticClass:"placeholder__info"},[a("div",{staticClass:"placeholder__avatar"}),a("p",{staticClass:"placeholder__name"},[t._v("p")]),a("p",{staticClass:"placeholder__date"},[t._v("p")])]),a("p",{staticClass:"placeholder__text"},[t._v("p")]),a("p",{staticClass:"placeholder__text"},[t._v("p")]),a("p",{staticClass:"placeholder__text"},[t._v("p")]),a("p",{staticClass:"placeholder__text"},[t._v("p")])])])}],M={name:"placeholder"},O=M,Y=(a("7a42"),Object(c["a"])(O,E,P,!1,null,"0ad727ef",null)),j=Y.exports;a("99af");function R(){for(var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:30,e=[],a=0;a<t;a++){var s=T.a.helpers.contextualCard();s.paragraph=T.a.lorem.paragraph(),s.img={src:"".concat("/infinite-scroll-sample/","/images/").concat(T.a.random.number({min:1,max:20}),".jpeg"),width:"".concat(T.a.random.number({min:100,max:700}),"px")},e.push(s)}return e}var k=6,G=3,z=180,B=2*G,F={name:"height-dynamic",data:function(){return{ESTIMATED_HEIGHT:z,anchorItem:{index:0,offset:0},listData:[],visibleData:[],topPlaceholders:0,bottomPlaceholders:0,firstAttachedItem:0,lastAttachedItem:0,lastScrollTop:0,cachedScrollY:[],cachedHeight:[],revising:!1}},computed:{scrollRunwayEnd:function(){var t=this.cachedHeight.reduce((function(t,e){return t+(e||z)}),0),e=t/this.cachedHeight.length;return isNaN(e)?this.listData.length*z:t+(this.listData.length-this.cachedHeight.length)*e}},mounted:function(){B=Math.ceil(this.$refs.scroller.offsetHeight/z),this.lastAttachedItem=B+G,this.fetchData(),this.updateVisibleData()},methods:{handleSizeChange:function(t,e){var a=e.height;this.calItemScrollY(t,a)},handleScroll:function(){if(!this.revising){var t=this.$refs.scroller.scrollTop-this.lastScrollTop;this.lastScrollTop=this.$refs.scroller.scrollTop,this.updateAnchorItem(t),this.updateVisibleData(),this.updatePlaceholder(t>=0),this.handleLoadMore()}},updateAnchorItem:function(t){var e=this;return Object(I["a"])(regeneratorRuntime.mark((function a(){var s,i,r,l;return regeneratorRuntime.wrap((function(a){while(1)switch(a.prev=a.next){case 0:if(s=e.anchorItem.index,i=e.anchorItem.offset,t+=i,r=s,t>=0){while(r<e.listData.length&&t>(e.cachedHeight[r]||z))e.cachedHeight[r]||e.$set(e.cachedHeight,r,z),t-=e.cachedHeight[r],r++;r>=e.listData.length?e.anchorItem={index:e.listData.length-1,offset:0}:e.anchorItem={index:r,offset:t}}else{while(t<0)e.cachedHeight[r-1]||e.$set(e.cachedHeight,r-1,z),t+=e.cachedHeight[r-1],r--;e.anchorItem=r<0?{index:0,offset:0}:{index:r,offset:t}}e.cachedScrollY[e.firstAttachedItem]<=-1&&(console.log("revising insufficient"),e.revising=!0,l=e.cachedHeight.slice(0,Math.max(0,e.anchorItem.index)).reduce((function(t,e){return t+e}),0),e.$refs.scroller.scrollTop=l+e.anchorItem.offset,e.lastScrollTop=e.$refs.scroller.scrollTop,0===e.$refs.scroller.scrollTop&&(e.anchorItem={index:0,offset:0}),e.calItemScrollY(),e.revising=!1);case 6:case"end":return a.stop()}}),a)})))()},calItemScrollY:function(t,e){var a=this;return Object(I["a"])(regeneratorRuntime.mark((function t(){var e,s,i,r,l,n,c,o,h,d,f,u,m,p,g;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,a.$nextTick();case 2:for(a.$refs.items.sort((function(t,e){return t.index-e.index})),e=a.$refs.items.findIndex((function(t){return t.index===a.anchorItem.index})),s=a.$refs.items[e],i=s.$el.getBoundingClientRect().height,a.$set(a.cachedScrollY,a.anchorItem.index,a.$refs.scroller.scrollTop-a.anchorItem.offset),a.$set(a.cachedHeight,a.anchorItem.index,i),r=e+1;r<a.$refs.items.length;r++)l=a.$refs.items[r],n=l.$el.getBoundingClientRect(),c=n.height,a.$set(a.cachedHeight,l.index,c),o=a.cachedScrollY[l.index-1]+a.cachedHeight[l.index-1],a.$set(a.cachedScrollY,l.index,o||0);for(h=e-1;h>=0;h--)d=a.$refs.items[h],a.$set(a.cachedHeight,d.index,d.$el.getBoundingClientRect().height),f=a.cachedScrollY[d.index+1]-a.cachedHeight[d.index],a.$set(a.cachedScrollY,d.index,f);if(a.cachedScrollY[0]>0){for(console.log("revising redundant"),a.revising=!0,u=a.cachedScrollY[0],m=Math.min(a.lastAttachedItem,a.listData.length),p=0;p<m;p++)a.$set(a.cachedScrollY,p,a.cachedScrollY[p]-u);g=a.cachedScrollY[a.anchorItem.index-1]?a.cachedScrollY[a.anchorItem.index-1]+a.anchorItem.offset:a.anchorItem.offset,a.$refs.scroller.scrollTop=g,a.lastScrollTop=a.$refs.scroller.scrollTop,a.revising=!1}case 11:case"end":return t.stop()}}),t)})))()},updateVisibleData:function(){var t=this.firstAttachedItem=Math.max(0,this.anchorItem.index-G);this.lastAttachedItem=this.firstAttachedItem+B+2*G;var e=Math.min(this.lastAttachedItem,this.listData.length);this.visibleData=this.listData.slice(t,e)},updatePlaceholder:function(t){t?(this.topPlaceholders=0,this.bottomPlaceholders=Math.min(k,Math.abs(this.listData.length-this.lastAttachedItem))):(this.topPlaceholders=Math.min(k,this.firstAttachedItem),this.bottomPlaceholders=0)},fetchData:function(){for(var t=R(),e=0;e<t.length;e++){var a=t[e];a.index=this.listData.length,this.listData.push(a)}this.updateVisibleData()},handleLoadMore:function(){var t=this.$refs.scroller.scrollTop+this.$refs.scroller.offsetHeight+z;(t>=this.scrollRunwayEnd||this.anchorItem.index===this.listData.length-1)&&this.fetchData()}},components:{Item:C,PlaceHolder:j}},L=F,V=(a("3b10"),Object(c["a"])(L,v,x,!1,null,"eafb1b9c",null)),N=V.exports,X=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("ul",{ref:"scroller",staticClass:"height-fixed",on:{scroll:t.handleScroll}},[a("li",{ref:"scrollRunway",staticClass:"height-fixed__scroll-runway",style:"transform: translate(0, "+t.scrollRunwayEnd+"px)"}),t._l(t.topPlaceholders,(function(e,s){return a("place-holder",{key:-s-1,staticClass:"height-fixed__placeholder",style:"transform: translate(0, "+t.FIXED_HEIGHT*(t.firstAttachedItem-s-1)+"px)"})})),t._l(t.visibleData,(function(t){return a("item",{key:t.username+t.phone,staticClass:"height-fixed__item",style:"transform: translate(0, "+t.scrollY+"px)",attrs:{data:t,index:t.index}})})),t._l(t.bottomPlaceholders,(function(e,s){return a("place-holder",{key:s+1,staticClass:"height-fixed__placeholder",style:"transform: translate(0, "+t.FIXED_HEIGHT*(t.lastAttachedItem+s+1)+"px)"})}))],2)},J=[],q=(a("dca8"),a("2909")),K=5,Q=3,U=180,W=2*Q,Z={name:"height-fixed",data:function(){return{FIXED_HEIGHT:U,anchorItem:{index:0,offset:0},listData:[],visibleData:[],topPlaceholders:0,bottomPlaceholders:0,firstAttachedItem:0,lastAttachedItem:0,scrollRunwayEnd:0,lastScrollTop:0}},mounted:function(){W=Math.ceil(this.$refs.scroller.offsetHeight/U),this.lastAttachedItem=W+Q,this.fetchData(),this.visibleData=this.listData.slice(this.firstAttachedItem,this.lastAttachedItem)},methods:{handleScroll:function(){var t=this.$refs.scroller.scrollTop-this.lastScrollTop;this.lastScrollTop=this.$refs.scroller.scrollTop,this.anchorItem.offset+=t;var e=t>=0;e?(this.anchorItem.offset>=U&&this.updateAnchorItem(),this.anchorItem.index-this.firstAttachedItem>=Q&&(this.firstAttachedItem=Math.min(this.listData.length-W,this.anchorItem.index-Q))):(this.$refs.scroller.scrollTop<=0?this.anchorItem={index:0,offset:0}:this.anchorItem.offset<0&&this.updateAnchorItem(),this.anchorItem.index-this.firstAttachedItem<Q&&(this.firstAttachedItem=Math.max(0,this.anchorItem.index-Q))),this.lastAttachedItem=Math.min(this.firstAttachedItem+W+2*Q,this.listData.length),this.visibleData=this.listData.slice(this.firstAttachedItem,this.lastAttachedItem),this.updatePlaceholder(e),this.handleLoadMore()},updateAnchorItem:function(){var t=Math.floor(this.$refs.scroller.scrollTop/U),e=this.$refs.scroller.scrollTop-t*U;this.anchorItem={index:t,offset:e}},calItemScrollY:function(t){for(var e=this.listData.length,a=0;a<t.length;a++,e++){var s=t[a];s.scrollY=this.scrollRunwayEnd+a*U,s.index=e,Object.freeze(s)}return t},updatePlaceholder:function(t){t?(this.topPlaceholders=0,this.bottomPlaceholders=Math.min(K,this.listData.length-this.lastAttachedItem)):(this.topPlaceholders=Math.min(K,this.firstAttachedItem),this.bottomPlaceholders=0)},fetchData:function(){var t;(t=this.listData).push.apply(t,Object(q["a"])(this.calItemScrollY(R()))),this.scrollRunwayEnd=this.listData.length*U},handleLoadMore:function(){var t=this.$refs.scroller.scrollTop+this.$refs.scroller.offsetHeight;t>=this.scrollRunwayEnd&&this.fetchData()}},components:{Item:C,PlaceHolder:j}},tt=Z,et=(a("fbbd"),Object(c["a"])(tt,X,J,!1,null,"b089f08c",null)),at=et.exports;s["a"].use(d["a"]),s["a"].config.productionTip=!1,new s["a"]({router:new d["a"]({routes:[{path:"/",component:_},{path:"/height-dynamic",component:N},{path:"/height-fixed",component:at}]}),render:function(t){return t(h)}}).$mount("#app")},"58e3":function(t,e,a){},"5a83":function(t,e,a){},"5c0b":function(t,e,a){"use strict";var s=a("9c0c"),i=a.n(s);i.a},"7a42":function(t,e,a){"use strict";var s=a("58e3"),i=a.n(s);i.a},"9c0c":function(t,e,a){},c6cb:function(t,e,a){},eefd:function(t,e,a){},fbbd:function(t,e,a){"use strict";var s=a("43cf"),i=a.n(s);i.a}});
//# sourceMappingURL=app.326a91d1.js.map